<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" lang="en">
<head th:insert="~{fragments/store/header :: head}">
    <style>
        .dot-flashing {
            position: relative;
            width: 1rem;
            height: 1rem;
            margin: 0 auto;
            border-radius: 50%;
            background-color: #6f42c1;
            animation: dotFlashing 1s infinite linear alternate;
            animation-delay: 0.5s;
        }

        @keyframes dotFlashing {
            0% { background-color: #6f42c1; }
            50%, 100% { background-color: #d6b3ff; }
        }

        .small-text span {
            font-size: 0.95rem;
        }
        .ttp-card-sub-header {
            margin-right: 10px; /* reduce spacing */
        }

    </style>
</head>

<body class="ttp-bg-white">
<div id="content-wrapper" class="content-wrapper-cls">
    <nav th:replace="~{fragments/store/navbar :: navbar-without-bag}"></nav>

    <div class="container" style="margin-top: 100px">

        <div id="user-facing-screen-1">
            <div th:replace="~{fragments/store/stepper :: stepper}"></div>
            <div th:replace="~{fragments/store/stepper :: stepper-sm}"></div>

            <div class="row justify-content-between align-items-start mt-5">
                <div class="col-sm-8">
                    <h2 class="ttp-color-purple mb-4">5. Order Review</h2>

                    <div class=" ttp-border-radius-10px p-4">

                        <!-- 3-Device Display -->
                        <div th:if="${storeShoppingBag.threeDeviceDisplayEnglishQuantity > 0 or
             storeShoppingBag.threeDeviceDisplayFrenchQuantity > 0 or
             storeShoppingBag.threeDeviceDisplayBilingualQuantity > 0}" class="mb-4">

                            <h5 class="ttp-color-fuschia">Kettle Display Quantities</h5>

                            <!-- English -->
                            <div class="d-flex align-items-center justify-content-between ttp-bg-color-light-shade-grey ttp-border-radius-10px p-3 mb-2">

                                <!-- Image -->
                                <div style="width: 120px; margin-right: 30px;">
                                    <img th:src="@{/images/sa_kettle_display_en_2023.png}"
                                         alt="Kettle Display English"
                                         class="img-fluid rounded">
                                </div>

                                <div class="d-flex align-items-center mx-3 p-2 bg-white border" style="border-color: #c10087; border-radius: 8px;">
                                    <span class="ttp-card-sub-header ttp-color-purple me-1" style="margin-right: 10px;">English:</span>
                                    <span class="fw-bold" th:text="${storeShoppingBag.threeDeviceDisplayEnglishQuantity}">0</span>
                                </div>

                                <div class="d-flex align-items-center mx-3 p-2 bg-white border" style="border-color: #c10087; border-radius: 8px;">
                                    <span class="ttp-card-sub-header ttp-color-purple me-1" style="margin-right: 10px;">French: </span>
                                    <span class="fw-bold" th:text="${storeShoppingBag.threeDeviceDisplayFrenchQuantity}">0</span>
                                </div>
                                <div class="d-flex align-items-center mx-3 p-2 bg-white border" style="border-color: #c10087; border-radius: 8px;">
                                    <span class="ttp-card-sub-header ttp-color-purple me-1" style="margin-right: 10px;">Bilingual: </span>
                                    <span class="fw-bold" th:text="${storeShoppingBag.threeDeviceDisplayBilingualQuantity}">0</span>
                                </div>

                            </div>
                        </div>


                        <div class="mb-4">
                            <h5 class="ttp-color-fuschia mt-4">Countertop Display Quantities</h5>

                            <!-- Flex row container for the 3 boxes -->
                            <div class="d-flex flex-wrap gap-3 j justify-content-start">
                                <!-- Box 1 -->
                                <div class="ttp-bg-color-light-shade-grey ttp-border-radius-10px p-3 text-center" style="width: 200px;margin-right: 40px;">
                                    <div class="mb-3">
                                        <img th:src="@{/images/tiptap_Salvation-Army_1device_7.5x10_2021_Final-BL-5.png}"
                                             alt="1-Device Display English"
                                             class="img-fluid rounded" style="max-height: 180px;">
                                    </div>
                                    <div class="d-flex flex-column align-items-center small-text">
                                        <div class="d-flex justify-content-between w-100" style="max-width: 200px;">
                                            <span class="ttp-card-sub-header ttp-color-purple">English</span>
                                            <span class="fw-bold ms-2" th:text="${storeShoppingBag.singleCurve5DollarEnglishQuantity}">1</span>
                                        </div>
                                        <div class="d-flex justify-content-between w-100" style="max-width: 200px;">
                                            <span class="ttp-card-sub-header ttp-color-purple">French</span>
                                            <span class="fw-bold ms-2" th:text="${storeShoppingBag.singleCurve5DollarFrenchQuantity}">0</span>
                                        </div>
                                        <div class="d-flex justify-content-between w-100" style="max-width: 200px;">
                                            <span class="ttp-card-sub-header ttp-color-purple">Bilingual</span>
                                            <span class="fw-bold ms-2" th:text="${storeShoppingBag.singleCurve5DollarBilingualQuantity}">0</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Repeat Box 2 and Box 3 (copy/paste the same structure above) -->
                                <div class="ttp-bg-color-light-shade-grey ttp-border-radius-10px p-3 text-center"  style="width: 200px;margin-right: 40px;">
                                    <div class="mb-3">
                                        <img th:src="@{/images/tiptap_Salvation-Army_1device_7.5x10_2021_Final-BL-10.png}"
                                             alt="1-Device Display English"
                                             class="img-fluid rounded" style="max-height: 180px;">
                                    </div>
                                    <div class="d-flex flex-column align-items-center small-text">
                                        <div class="d-flex justify-content-between w-100" style="max-width: 200px;">
                                            <span class="ttp-card-sub-header ttp-color-purple">English</span>
                                            <span class="fw-bold ms-2" th:text="${storeShoppingBag.singleCurve10DollarEnglishQuantity}">1</span>
                                        </div>
                                        <div class="d-flex justify-content-between w-100" style="max-width: 200px;">
                                            <span class="ttp-card-sub-header ttp-color-purple">French</span>
                                            <span class="fw-bold ms-2" th:text="${storeShoppingBag.singleCurve10DollarFrenchQuantity}">0</span>
                                        </div>
                                        <div class="d-flex justify-content-between w-100" style="max-width: 200px;">
                                            <span class="ttp-card-sub-header ttp-color-purple">Bilingual</span>
                                            <span class="fw-bold ms-2" th:text="${storeShoppingBag.singleCurve10DollarBilingualQuantity}">0</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Box 3 -->
                                <div class="ttp-bg-color-light-shade-grey ttp-border-radius-10px p-3 text-center" style="width: 200px;">
                                    <div class="mb-3">
                                        <img th:src="@{/images/tiptap_Salvation-Army_1device_7.5x10_2021_Final-BL-20.png}"
                                             alt="1-Device Display English"
                                             class="img-fluid rounded" style="max-height: 180px;">
                                    </div>
                                    <div class="d-flex flex-column align-items-center small-text">
                                        <div class="d-flex justify-content-between w-100" style="max-width: 200px;">
                                            <span class="ttp-card-sub-header ttp-color-purple">English</span>
                                            <span class="fw-bold ms-2" th:text="${storeShoppingBag.singleCurve20DollarEnglishQuantity}">1</span>
                                        </div>
                                        <div class="d-flex justify-content-between w-100" style="max-width: 200px;">
                                            <span class="ttp-card-sub-header ttp-color-purple">French</span>
                                            <span class="fw-bold ms-2" th:text="${storeShoppingBag.singleCurve20DollarFrenchQuantity}">0</span>
                                        </div>
                                        <div class="d-flex justify-content-between w-100" style="max-width: 200px;">
                                            <span class="ttp-card-sub-header ttp-color-purple">Bilingual</span>
                                            <span class="fw-bold ms-2" th:text="${storeShoppingBag.singleCurve20DollarBilingualQuantity}">0</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Device Only Quantities -->
                        <!-- Device Only Quantities -->
                        <div th:if="${storeShoppingBag.device5DollarQty > 0 or
             storeShoppingBag.device10DollarQty > 0 or
             storeShoppingBag.device20DollarQty > 0}" class="mb-4">

                            <h5 class="ttp-color-fuschia mt-4">Device Quantities</h5>

                            <!-- Flex container for all device cards in a row -->
                            <div class="d-flex justify-content-start gap-3 flex-nowrap">

                            <!-- $5 Device -->
                                <div th:if="${storeShoppingBag.device5DollarQty > 0}"
                                     class="ttp-bg-color-light-shade-grey ttp-border-radius-10px p-3 text-center"
                                     style="width: 200px;margin-right: 50px;">
                                    <div class="mb-2">
                                        <img th:src="@{/images/dollar5-device.png}"
                                             alt="$5 Device"
                                             class="img-fluid rounded"
                                             style="max-height: 100px;">
                                    </div>
                                    <div class="small-text">
                                        <span class="ttp-card-sub-header ttp-color-purple d-block mb-1">$5 Device</span>
                                        Quantity: <span class="fw-bold" th:text="${storeShoppingBag.device5DollarQty}">1</span>
                                    </div>
                                </div>

                                <!-- $10 Device -->
                                <div th:if="${storeShoppingBag.device10DollarQty > 0}"
                                     class="ttp-bg-color-light-shade-grey ttp-border-radius-10px p-3 text-center"
                                     style="width: 200px;margin-right: 40px;">
                                    <div class="mb-2">
                                        <img th:src="@{/images/dollar10-device.png}"
                                             alt="$10 Device"
                                             class="img-fluid rounded"
                                             style="max-height: 100px;">
                                    </div>
                                    <div class="small-text">
                                        <span class="ttp-card-sub-header ttp-color-purple d-block mb-1">$10 Device</span>
                                        Quantity: <span class="fw-bold" th:text="${storeShoppingBag.device10DollarQty}">1</span>
                                    </div>
                                </div>

                                <!-- $20 Device -->
                                <div th:if="${storeShoppingBag.device20DollarQty > 0}"
                                     class="ttp-bg-color-light-shade-grey ttp-border-radius-10px p-3 text-center"
                                     style="width: 200px;">
                                    <div class="mb-2">
                                        <img th:src="@{/images/dollar20-device.png}"
                                             alt="$20 Device"
                                             class="img-fluid rounded"
                                             style="max-height: 100px;">
                                    </div>
                                    <div class="small-text">
                                        <span class="ttp-card-sub-header ttp-color-purple d-block mb-1">$20 Device</span>
                                        Quantity: <span class="fw-bold" th:text="${storeShoppingBag.device20DollarQty}">1</span>
                                    </div>
                                </div>

                            </div>
                        </div>


                    </div>

                    <a href="/canada-store/order" class="ttp-card-sub-header-md fuschia-a pt-4 d-inline-block">
                        + keep shopping
                    </a>
                </div>

                <div class="col-sm-4 d-flex justify-content-center">
                    <div class="mt-5" style="min-width: 300px; max-width: 300px;">
                        <div class="ttp-bg-color-light-shade-grey ttp-border-radius-10px p-3 text-center" style="margin-top: 70px;">
                            <div class="ttp-card-header ttp-color-purple pt-2">fees & totals</div>

                            <div class="ttp-card-sub-header ttp-color-fuschia mt-4">Shipping</div>
                            <div class="ttp-color-dark-grey" style="font-size: 20px; font-weight: bold;">
                                $<span th:text="${fmt.formatCents(storeShoppingBag.shippingAmountInCents)}">0.00</span>
                            </div>


                            <div class="ttp-card-sub-header ttp-color-fuschia mt-4">Taxes</div>
                            <div class="ttp-color-dark-grey" style="font-size: 20px; font-weight: bold;">
                                $<span th:text="${fmt.formatCents(storeShoppingBag.taxAmountInCents)}">0.00</span>
                            </div>

                            <div class="ttp-card-sub-header ttp-color-fuschia mt-4">Total</div>
                            <div class="ttp-fs-24px ttp-fw-700 ttp-color-purple mb-3">
                                $<span th:text="${#numbers.formatDecimal(storeShoppingBag.totalAmountFormatted() + (storeShoppingBag.taxAmountInCents + storeShoppingBag.shippingAmountInCents) / 100.0, 1, 'COMMA', 2, 'POINT')}">0.00</span>
                            </div>

                        </div>
                        <form th:action="@{/canada-store/order-review}" method="post" class="mt-4 text-center" id="order-review-form">
                            <button type="submit" class="ttp-button-primary" style="width: 220px;">Submit Order</button>
                        </form>
                    </div>
                </div>
            </div>
            <div th:insert="~{fragments/store/footer :: footer}" style="padding-top: 250px;"></div>
        </div>
        <div id="user-facing-screen-2" style="display: none;">
            <div th:replace="~{fragments/store/stepper :: stepper}"></div>
            <div class="text-center" style="padding-top:100px; ">
                <h4 class="ttp-color-purple text-center">Please wait, order processing</h4><br>
                <div class="row justify-content-center align-items-center">
                    <div class="dot-flashing"></div>
                </div>
            </div>
        </div>


    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const form = document.getElementById('order-review-form');
        if (form) {
            form.addEventListener('submit', function () {
                document.getElementById('user-facing-screen-2').style.display = 'block';
                document.getElementById('user-facing-screen-1').style.display = 'none';
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }
    });
</script>

</body>
</html>
