<!DOCTYPE html>
<html
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:th="http://www.thymeleaf.org"
        lang="en"
>

<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.14.2/dist/bootstrap-table.min.css">
    <link rel="icon" type="image/x" href="/favicon.ico">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <title>tiptap</title>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Mulish:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/app.css"/>

    <meta charset="UTF-8" content="MBoyQBsQODEBNHceP31SFiBYDEkgOgcdGyaryiAu6VAXi5kLp3yxUXKn" csrf-param="_csrf_token"
          method-param="_method" name="csrf-token">

    <style>
        .hidden {
            display: none;
        }

        .card {
            height: 100% !important;
        }

        .ttp-section-title-primary {
            background-color: #9E017D;
            border-radius: 8px;
            padding: 10px;
            color: #FFFFFF;
            font-weight: 600;
        }
    </style>
</head>

<body style="background-color: #fcfcfc">

<div id="content-wrapper" class="">

    <nav th:replace="~{fragments/navbar :: navbar}"></nav>

    <div class="container d-flex mt-5">

        <main
                id=""
                class="bg-lightgrey flex-grow-6 flex-shrink-1 px-4 py-5 w-100"
                role="main"
        >

            <form method="POST" th:object="${form}" id="order-form">

                <div class="d-flex justify-content-between align-items-center mt-3 mb-3">


                    <div class="d-flex justify-content-between align-items-center">

                        <a class="btn btn-outline-primary btn-small position-relative d-flex align-items-center"
                           href="/store">
                            <svg th:replace="~{fragments/svg_fragments :: svg-left-arrow}"></svg>
                        </a>

                        <a class="btn btn-outline-primary btn-small position-relative d-flex align-items-center ml-2"
                           href="/store">
                            <svg th:replace="~{fragments/svg_fragments :: svg-store-home}"></svg>
                        </a>

                    </div>

                    <button class="btn btn-outline-primary btn-small position-relative d-flex align-items-center"
                            type="submit">
                        <svg th:replace="~{fragments/svg_fragments :: svg-right-arrow}"></svg>
                    </button>

                </div>

                <section class="mb-3">
                    <div class="mb-4">
                        <header>
                            <h1>Checkout</h1>
                        </header>

                        <p class="">
                            Please fill your information and click "Continue" to see order summary.
                        </p>
                    </div>
                </section>


                <span th:if="${invalidForm}" th:text="${invalidForm}" style="color: red;"></span>
                <span th:if="${invalidAddress}" th:text="${invalidAddress}" style="color: red;"></span>

                <div class="row justify-content-between">

                    <div class="col-sm">

                        <div id="customer-information-section" class="" hidden>
                            <div class="ttp-section-title-primary mt-3">
                                <span>Customer Information</span>
                            </div>
                            <hr class="mb-3">
                            <div class="row g-3">
                                <div class="col-12 mt-3">
                                    <label for="customerName" class="form-label ">Parish Name</label>
                                    <input type="text" class="form-control form-item" id="customerName"
                                           name="customerName"
                                           th:value="${form.getCustomerName()}"
                                           th:field="*{customerName}"
                                    >
                                    <span th:if="${#fields.hasErrors('customerName')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{customerName}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-2 mt-3">
                                    <label for="customerPhoneCountryCode" class="form-label ">Country
                                        Code</label>
                                    <select class="custom-select form-item bg-white" id="customerPhoneCountryCode"
                                            name="customerPhoneCountryCode"
                                            th:value="${form.getCustomerPhoneCountryCode()}"
                                            th:field="*{customerPhoneCountryCode}"
                                    >
                                        <option value="+1">+1</option>
                                    </select>
                                    <span th:if="${#fields.hasErrors('customerPhoneCountryCode')}"
                                          class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{customerPhoneCountryCode}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-4 mt-3">
                                    <label for="customerPhone" class="form-label ">Phone</label>
                                    <input type="text" class="form-control form-item" id="customerPhone"
                                           name="customerPhone"
                                           maxlength="14"
                                           th:value="${form.getCustomerPhone()}"
                                           th:field="*{customerPhone}"
                                    >
                                    <span th:if="${#fields.hasErrors('customerPhone')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{customerPhone}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-6 mt-3">
                                    <label for="customerEmail" class="form-label ">Email</label>
                                    <input type="email" class="form-control form-item" id="customerEmail"
                                           name="customerEmail"
                                           maxlength="200"
                                           th:value="${form.getCustomerEmail()}"
                                           th:field="*{customerEmail}"
                                    >
                                    <span th:if="${#fields.hasErrors('customerEmail')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{customerEmail}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-6 mt-3">
                                    <label for="customerPrefContactMethod" class="form-label ">Preferred Contact
                                        Method</label>
                                    <select class="custom-select form-item bg-white" id="customerPrefContactMethod"
                                            name="customerPrefContactMethod"
                                            th:value="${form.getCustomerPrefContactMethod()}"
                                            th:field="*{customerPrefContactMethod}"
                                    >
                                        <option value="" hidden></option>
                                        <option value="Email">Email</option>
                                        <option value="Phone">Phone</option>
                                    </select>
                                    <span th:if="${#fields.hasErrors('customerPrefContactMethod')}"
                                          class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{customerPrefContactMethod}"></span>
                                </span>
                                </div>

                            </div>
                        </div>

                        <div id="contact-information-section" class="mb-5">
                            <div class="ttp-section-title-primary">
                                <span>Contact Information</span>
                            </div>
                            <hr class="mb-3">

                            <div class="row g-3">
                                <div class="col-12 col-md-6 mt-3">
                                    <label for="contactFirstName" class="form-label ">First Name</label>
                                    <input type="text" class="form-control form-item" id="contactFirstName"
                                           name="contactFirstName"
                                           maxlength="100"
                                           th:value="${form.getContactFirstName()}"
                                           th:field="*{contactFirstName}"
                                           required
                                    >
                                    <span th:if="${#fields.hasErrors('contactFirstName')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{contactFirstName}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-6 mt-3">
                                    <label for="contactLastName" class="form-label ">Last Name</label>
                                    <input type="text" class="form-control form-item" id="contactLastName"
                                           name="contactLastName"
                                           maxlength="100"
                                           th:value="${form.getContactLastName()}"
                                           th:field="*{contactLastName}"
                                           required
                                    >
                                    <span th:if="${#fields.hasErrors('contactLastName')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{contactLastName}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-2 mt-3">
                                    <label for="contactPhoneCountryCode" class="form-label ">Country
                                        Code</label>
                                    <select class="custom-select form-item bg-white" id="contactPhoneCountryCode"
                                            name="contactPhoneCountryCode"
                                            th:value="${form.getContactPhoneCountryCode()}"
                                            th:field="*{contactPhoneCountryCode}"
                                            required
                                    >
                                        <option value="+1">+1</option>
                                    </select>
                                    <span th:if="${#fields.hasErrors('contactPhoneCountryCode')}"
                                          class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{contactPhoneCountryCode}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-4 mt-3">
                                    <label for="contactPhone" class="form-label ">Phone</label>
                                    <input type="tel" class="form-control form-item" id="contactPhone"
                                           name="contactPhone"
                                           maxlength="14"
                                           th:value="${form.getContactPhone()}"
                                           th:field="*{contactPhone}"
                                           required
                                    >
                                    <span th:if="${#fields.hasErrors('contactPhone')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{contactPhone}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-6 mt-3">
                                    <label for="contactEmail" class="form-label ">Email</label>
                                    <input type="email" class="form-control form-item" id="contactEmail"
                                           name="contactEmail"
                                           maxlength="200"
                                           th:value="${form.getContactEmail()}"
                                           th:field="*{contactEmail}"
                                           required
                                    >
                                    <span th:if="${#fields.hasErrors('contactEmail')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{contactEmail}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-6 mt-3">
                                    <label for="contactPrefContactMethod" class="form-label ">Preferred
                                        Contact
                                        Method</label>
                                    <select class="custom-select form-item bg-white" id="contactPrefContactMethod"
                                            name="contactPrefContactMethod"
                                            th:value="${form.getContactPrefContactMethod()}"
                                            th:field="*{contactPrefContactMethod}"
                                            required
                                    >
                                        <option value="" hidden></option>
                                        <option value="Email">Email</option>
                                        <option value="Phone">Phone</option>
                                    </select>
                                    <span th:if="${#fields.hasErrors('contactPrefContactMethod')}"
                                          class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{contactPrefContactMethod}"></span>
                                </span>
                                </div>

                            </div>
                        </div>

                        <div id="customer-category-section" class="" hidden>
                            <div class="ttp-section-title-primary mt-5">
                                <span>Customer Category</span>
                            </div>
                            <hr class="mb-3">

                            <div class="row g-3">

                                <div class="col-12 col-md-6 mt-3">
                                    <label for="customerType" class="form-label ">Type</label>
                                    <select class="custom-select form-item bg-white" id="customerType"
                                            name="customerType"
                                            th:value="${form.getCustomerType()}"
                                            th:field="*{customerType}"
                                    >
                                        <option value="" hidden></option>
                                        <option value="Direct">Direct</option>
                                        <option value="Enterprise">Enterprise</option>
                                        <option value="Referral">Referral</option>
                                        <option value="Reseller">Reseller</option>
                                    </select>
                                    <span th:if="${#fields.hasErrors('customerType')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{customerType}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-6 mt-3">
                                    <label for="customerReferral" class="form-label">Referral</label>
                                    <input type="text" class="form-control form-item" id="customerReferral"
                                           name="customerReferral"
                                           th:value="${form.getCustomerReferral()}"
                                           th:field="*{customerReferral}"
                                    >
                                    <span th:if="${#fields.hasErrors('customerReferral')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{customerReferral}"></span>
                                </span>
                                </div>

                            </div>
                        </div>

                        <div id="organization-information-section" class="" hidden>
                            <div class="ttp-section-title-primary mt-5">
                                <span>Organization Information</span>
                            </div>
                            <hr class="mb-3">

                            <div class="row g-3">

                                <div class="col-12 col-md-4 mt-3">
                                    <label for="parent" class="form-label ">Parent</label>
                                    <input type="number" class="form-control form-item" id="parent" name="parent"
                                           th:value="${form.getParent()}"
                                           th:field="*{parent}"
                                    >
                                    <span th:if="${#fields.hasErrors('parent')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{parent}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-4 mt-3">
                                    <label for="child" class="form-label ">Child</label>
                                    <input type="number" class="form-control form-item" id="child" name="child"
                                           th:value="${form.getChild()}"
                                           th:field="*{child}"
                                    >
                                    <span th:if="${#fields.hasErrors('child')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{child}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-4 mt-3">
                                    <label for="grandChild" class="form-label ">Grand Child</label>
                                    <input type="number" class="form-control form-item" id="grandChild"
                                           name="grandChild"
                                           th:value="${form.getGrandChild()}"
                                           th:field="*{grandChild}"
                                    >
                                    <span th:if="${#fields.hasErrors('grandChild')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{grandChild}"></span>
                                </span>
                                </div>

                            </div>

                        </div>

                        <div id="program-details-section" class="" hidden>
                            <div class="ttp-section-title-primary mt-5">
                                <span>Program Details</span>
                            </div>
                            <hr class="mb-3">

                            <div class="row g-3">
                                <div class="col-12 col-md-6 mt-3">
                                    <label for="partnerSponsoring" class="form-label ">Partner
                                        Sponsoring</label>
                                    <div class="mb-2"><small>Is there a partner sponsoring this financially for the
                                        end-user?</small></div>
                                    <select class="custom-select form-item bg-white" id="partnerSponsoring"
                                            name="partnerSponsoring"
                                            th:value="${form.getPartnerSponsoring()}"
                                            th:field="*{partnerSponsoring}">
                                        <option value="" hidden></option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                    <span th:if="${#fields.hasErrors('partnerSponsoring')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{partnerSponsoring}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-6"></div>
                            </div>

                            <div class="row g-3 mt-3" id="partner-sponsoring-fields-section">

                                <div class="col-12 col-md-6 mt-3">
                                    <label for="sponsorshipBeneficiary" class="form-label ">Sponsorship
                                        Beneficiary</label>
                                    <input type="text" class="form-control form-item" id="sponsorshipBeneficiary"
                                           name="sponsorshipBeneficiary"
                                           th:value="${form.getSponsorshipBeneficiary()}"
                                           th:field="*{sponsorshipBeneficiary}"
                                    >
                                    <span th:if="${#fields.hasErrors('sponsorshipBeneficiary')}"
                                          class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{sponsorshipBeneficiary}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-6 mt-3">
                                    <label for="programName" class="form-label ">Program Name</label>
                                    <input type="text" class="form-control form-item" id="programName"
                                           name="programName"
                                           th:value="${form.getProgramName()}"
                                           th:field="*{programName}"
                                    >
                                    <span th:if="${#fields.hasErrors('programName')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{programName}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-6 mt-3">
                                    <label for="programLeadName" class="form-label ">Program Lead
                                        Name</label>
                                    <input type="text" class="form-control form-item" id="programLeadName"
                                           name="programLeadName"
                                           th:value="${form.getProgramLeadName()}"
                                           th:field="*{programLeadName}"
                                    >
                                    <span th:if="${#fields.hasErrors('programLeadName')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{programLeadName}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-6 mt-3">
                                    <label for="programLeadEmail" class="form-label ">Program Lead
                                        Email</label>
                                    <input type="email" class="form-control form-item" id="programLeadEmail"
                                           name="programLeadEmail"
                                           th:value="${form.getProgramLeadEmail()}"
                                           th:field="*{programLeadEmail}"
                                    >
                                    <span th:if="${#fields.hasErrors('programLeadEmail')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{programLeadEmail}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-3 mt-3">
                                    <label for="programLeadPhoneCountryCode" class="form-label ">Program
                                        Lead
                                        Country Code</label>
                                    <select class="custom-select form-item bg-white"
                                            id="programLeadPhoneCountryCode"
                                            name="programLeadPhoneCountryCode"
                                            th:value="${form.getProgramLeadPhoneCountryCode()}"
                                            th:field="*{programLeadPhoneCountryCode}">
                                        <option value="+1">+1</option>
                                    </select>
                                    <span th:if="${#fields.hasErrors('programLeadPhoneCountryCode')}"
                                          class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{programLeadPhoneCountryCode}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-3 mt-3">
                                    <label for="programLeadPhone" class="form-label ">Program Lead
                                        Phone</label>
                                    <input type="text" class="form-control form-item" id="programLeadPhone"
                                           name="programLeadPhone"
                                           maxlength="14"
                                           th:value="${form.getProgramLeadPhone()}"
                                           th:field="*{programLeadPhone}"
                                    >
                                    <span th:if="${#fields.hasErrors('programLeadPhone')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{programLeadPhone}"></span>
                                </span>
                                </div>

                            </div>

                        </div>

                        <div id="shipping-information-section" class="mb-5">
                            <div class="ttp-section-title-primary mt-5">
                                <span>Shipping Information</span>
                            </div>
                            <hr class="mb-3">

                            <div class="row g-3">

                                <div class="col-12 mt-3">
                                    <label for="attentionTo" class="form-label ">Attention To</label>
                                    <input type="text" class="form-control form-item" id="attentionTo"
                                           name="attentionTo"
                                           maxlength="200"
                                           th:value="${form.getAttentionTo()}"
                                           th:field="*{attentionTo}"
                                           required
                                    >
                                    <span th:if="${#fields.hasErrors('attentionTo')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{attentionTo}"></span>
                                </span>
                                </div>

                                <div class="col-12 mt-3">
                                    <label for="shippingAddr1" class="form-label ">Address Line 1</label>
                                    <small class="mb-2">
                                        <br>Please note: the use of "PO Box" is not allowed.
                                    </small>
                                    <input type="text" class="form-control form-item" id="shippingAddr1"
                                           name="shippingAddr1"
                                           maxlength="200"
                                           th:value="${form.getShippingAddr1()}"
                                           th:field="*{shippingAddr1}"
                                           required
                                    >
                                    <span th:if="${#fields.hasErrors('shippingAddr1')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{shippingAddr1}"></span>
                                </span>
                                </div>

                                <div class="col-12 mt-3">
                                    <label for="shippingAddr2" class="form-label">Address Line 2</label>
                                    <input type="text" class="form-control form-item" id="shippingAddr2"
                                           name="shippingAddr2"
                                           maxlength="200"
                                           th:value="${form.getShippingAddr2()}"
                                           th:field="*{shippingAddr2}"
                                    >
                                    <span th:if="${#fields.hasErrors('shippingAddr2')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{shippingAddr2}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-6 mt-3">
                                    <label for="shippingCountry" class="form-label ">Country</label>
                                    <select class="custom-select form-item bg-white" id="shippingCountry"
                                            name="shippingCountry"
                                            th:value="${form.getShippingCountry()}"
                                            th:field="*{shippingCountry}"
                                            required
                                    >
                                        <option value="Canada">Canada</option>
                                        <option value="US">US</option>
                                    </select>
                                    <span th:if="${#fields.hasErrors('shippingCountry')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{shippingCountry}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-6 mt-3" id="shipping-state-ca-field">
                                    <label for="shippingStateCA" class="form-label ">State/Province/Region</label>
                                    <select class="custom-select form-item bg-white" id="shippingStateCA"
                                            name="shippingStateCA"
                                            th:value="${form.getShippingStateCA()}"
                                            th:field="*{shippingStateCA}"
                                            required
                                    >
                                        <option value="Alberta">Alberta</option>
                                        <option value="British Columbia">British Columbia</option>
                                        <option value="Manitoba">Manitoba</option>
                                        <option value="New Brunswick">New Brunswick</option>
                                        <option value="Newfoundland and Labrador">Newfoundland and Labrador</option>
                                        <option value="Nova Scotia">Nova Scotia</option>
                                        <option value="Northwest Territories">Northwest Territories</option>
                                        <option value="Nunavut">Nunavut</option>
                                        <option value="Ontario">Ontario</option>
                                        <option value="Prince Edward Island">Prince Edward Island</option>
                                        <option value="Quebec">Quebec</option>
                                        <option value="Saskatchewan">Saskatchewan</option>
                                        <option value="Yukon">Yukon</option>
                                    </select>
                                    <span th:if="${#fields.hasErrors('shippingStateCA')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{shippingStateCA}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-6 mt-3" id="shipping-state-us-field">
                                    <label for="shippingStateUS" class="form-label ">State/Province/Region</label>
                                    <select class="custom-select form-item bg-white" id="shippingStateUS"
                                            name="shippingStateUS"
                                            th:value="${form.getShippingStateUS()}"
                                            th:field="*{shippingStateUS}"
                                            required
                                    >
                                        <option value="Alabama">Alabama</option>
                                        <option value="Alaska">Alaska</option>
                                        <option value="Arizona">Arizona</option>
                                        <option value="Arkansas">Arkansas</option>
                                        <option value="California">California</option>
                                        <option value="Colorado">Colorado</option>
                                        <option value="Connecticut">Connecticut</option>
                                        <option value="Delaware">Delaware</option>
                                        <option value="District Of Columbia">District Of Columbia</option>
                                        <option value="Florida">Florida</option>
                                        <option value="Georgia">Georgia</option>
                                        <option value="Hawaii">Hawaii</option>
                                        <option value="Idaho">Idaho</option>
                                        <option value="Illinois">Illinois</option>
                                        <option value="Indiana">Indiana</option>
                                        <option value="Iowa">Iowa</option>
                                        <option value="Kansas">Kansas</option>
                                        <option value="Kentucky">Kentucky</option>
                                        <option value="Louisiana">Louisiana</option>
                                        <option value="Maine">Maine</option>
                                        <option value="Maryland">Maryland</option>
                                        <option value="Massachusetts">Massachusetts</option>
                                        <option value="Michigan">Michigan</option>
                                        <option value="Minnesota">Minnesota</option>
                                        <option value="Mississippi">Mississippi</option>
                                        <option value="Missouri">Missouri</option>
                                        <option value="Montana">Montana</option>
                                        <option value="Nebraska">Nebraska</option>
                                        <option value="Nevada">Nevada</option>
                                        <option value="New Hampshire">New Hampshire</option>
                                        <option value="New Jersey">New Jersey</option>
                                        <option value="New Mexico">New Mexico</option>
                                        <option value="New York">New York</option>
                                        <option value="North Carolina">North Carolina</option>
                                        <option value="North Dakota">North Dakota</option>
                                        <option value="Ohio">Ohio</option>
                                        <option value="Oklahoma">Oklahoma</option>
                                        <option value="Oregon">Oregon</option>
                                        <option value="Pennsylvania">Pennsylvania</option>
                                        <option value="Rhode Island">Rhode Island</option>
                                        <option value="South Carolina">South Carolina</option>
                                        <option value="South Dakota">South Dakota</option>
                                        <option value="Tennessee">Tennessee</option>
                                        <option value="Texas">Texas</option>
                                        <option value="Utah">Utah</option>
                                        <option value="Vermont">Vermont</option>
                                        <option value="Virginia">Virginia</option>
                                        <option value="Washington">Washington</option>
                                        <option value="West Virginia">West Virginia</option>
                                        <option value="Wisconsin">Wisconsin</option>
                                        <option value="Wyoming">Wyoming</option>
                                    </select>
                                    <span th:if="${#fields.hasErrors('shippingStateUS')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{shippingStateUS}"></span>
                                </span>
                                </div>


                                <div class="col-12 col-md-6 mt-3">
                                    <label for="shippingCity" class="form-label ">City</label>
                                    <input type="text" class="form-control form-item" id="shippingCity"
                                           name="shippingCity"
                                           maxlength="100"
                                           th:value="${form.getShippingCity()}"
                                           th:field="*{shippingCity}"
                                           required
                                    >
                                    <span th:if="${#fields.hasErrors('shippingCity')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{shippingCity}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-6 mt-3" id="shipping-zip-code-field">
                                    <label for="shippingZip" class="form-label ">Zip Code</label>
                                    <input type="text" class="form-control form-item" id="shippingZip"
                                           name="shippingZip"
                                           maxlength="5"
                                           th:value="${form.getShippingZip()}"
                                           th:field="*{shippingZip}"
                                           pattern="\d{5}"
                                           title="Please enter a 5-digit ZIP Code"
                                           required
                                    >
                                    <span th:if="${#fields.hasErrors('shippingZip')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{shippingZip}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-6 mt-3" id="shipping-postal-code-field">
                                    <label for="shippingPostalCode" class="form-label ">Postal Code</label>
                                    <input type="text" class="form-control form-item" id="shippingPostalCode"
                                           name="shippingPostalCode"
                                           maxlength="7"
                                           th:value="${form.getShippingPostalCode()}"
                                           th:field="*{shippingPostalCode}"
                                           pattern="[A-Za-z]\d[A-Za-z] \d[A-Za-z]\d"
                                           title="Please enter a postal code in the A1A 1A1 format"
                                           required
                                    >
                                    <span th:if="${#fields.hasErrors('shippingPostalCode')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{shippingPostalCode}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-2 mt-3">
                                    <label for="shippingPhoneCountryCode" class="form-label ">Country
                                        Code</label>
                                    <select class="custom-select form-item bg-white" id="shippingPhoneCountryCode"
                                            name="shippingPhoneCountryCode"
                                            th:value="${form.getShippingPhoneCountryCode()}"
                                            th:field="*{shippingPhoneCountryCode}"
                                            required
                                    >
                                        <option value="+1">+1</option>
                                    </select>
                                    <span th:if="${#fields.hasErrors('shippingPhoneCountryCode')}"
                                          class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{shippingPhoneCountryCode}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-4 mt-3">
                                    <label for="shippingPhone" class="form-label ">Phone</label>
                                    <input type="tel" class="form-control form-item" id="shippingPhone"
                                           name="shippingPhone"
                                           maxlength="14"
                                           th:value="${form.getShippingPhone()}"
                                           th:field="*{shippingPhone}"
                                           required
                                    >
                                    <span th:if="${#fields.hasErrors('shippingPhone')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{shippingPhone}"></span>
                                </span>
                                </div>

                                <div class="col-12 col-md-6 mt-3">
                                    <label for="shippingEmail" class="form-label ">Email</label>
                                    <input type="email" class="form-control form-item" id="shippingEmail"
                                           name="shippingEmail"
                                           maxlength="200"
                                           th:value="${form.getShippingEmail()}"
                                           th:field="*{shippingEmail}"
                                           required
                                    >
                                    <span th:if="${#fields.hasErrors('shippingEmail')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{shippingEmail}"></span>
                                </span>
                                </div>

                            </div>

                        </div>

                        <div id="memo-section" class="mb-5">
                            <div class="ttp-section-title-primary mt-5">
                                <span>Notes / Details</span>
                            </div>
                            <hr class="mb-3">
                            <div class="mb-2"></div>
                            <small class="mb-2">
                                Add any relevant notes or details here. This can include special instructions,
                                preferences, or additional
                                information you'd like to share. Feel free to leave this field blank if you don't
                                have
                                any additional notes.
                            </small>
                            <div class="mb-2"></div>
                            <div class="row">
                                <div class="col-12 mt-3">
                                    <label for="memo" hidden></label>
                                    <textarea
                                            class="form-control form-item"
                                            rows="4"
                                            id="memo"
                                            name="memo"
                                            maxlength="250"
                                            placeholder="Notes or details"
                                            th:value="${form.getMemo()}"
                                            th:field="*{memo}"
                                    ></textarea>
                                    <span th:if="${#fields.hasErrors('memo')}" class="text-danger">
                                    <span th:replace="~{/fragments/svg_fragments :: svg-danger}"></span>
                                    <span th:errors="*{memo}"></span>
                                </span>
                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="col-sm card" style="max-width: 320px; min-width: 320px; margin: 0 8px 0 8px">
                        <div class="card-body p-0">

                            <div id="shopping-bag-section" class="bg-white mb-5" style="border-radius: 20px;">

                                <table th:fragment="store-bag-table"
                                       id="store-bag-table"
                                       class="table table-borderless mt-3"
                                       style="border-radius: 20px">

                                    <tr style="border: none">

                                        <td style="" colspan="3">
                                            <p class="text-black font-weight-bold">Please continue to see<br>Order
                                                Summary</p>
                                        </td>

                                    </tr>

                                    <tr style="border: none">
                                        <td colspan="3" class="pt-1">
                                            <button class="btn btn-block btn-small btn-primary" name="action"
                                                    type="submit" style="text-transform: none">
                                                Continue
                                            </button>
                                        </td>
                                    </tr>


                                </table>

                            </div>

                        </div>
                    </div>

                </div>

            </form>


            <dialog th:fragment="order-submitting-modal" id="submitDialog" class="rounded border-0">
                <div id="loader" class="align-items-center justify-content-center text-center border-0">
                    <div id="dialogSpinner" class="spinner-border m-5 text-center text-fuscia" role="status"></div>
                    <p class="dialogText text-fuscia">Please wait.</p>
                    <p class="dialogText text-fuscia">Calculating Shipping Fee and Tax...</p>
                </div>
            </dialog>


        </main>
    </div>
</div>

<script type="text/javascript" src="/js/app.js"></script>

<script>

    document.getElementById('order-form').addEventListener('submit', function (event) {
        showDialog("submitDialog");
        this.submit()
    });


    document.addEventListener('DOMContentLoaded', function () {
        // Prevent "Enter" key to submit form
        window.addEventListener('keydown', function (event) {
            if (event.keyCode === 13) {
                event.preventDefault();
                return false;
            }
        });

        let iCase = 1;
        if(document.getElementById('shippingPostalCode').value === "" && document.getElementById('shippingZip').value === ""){
            iCase = 0;
        }

        updateShippingMask(iCase);

        document.getElementById('shippingCountry').addEventListener('change', function () {
            updateShippingMask(0);
        });
    });

    document.getElementById('contactPhone').addEventListener('input', handlePhoneInput);
    document.getElementById('customerPhone').addEventListener('input', handlePhoneInput);
    document.getElementById('shippingPhone').addEventListener('input', handlePhoneInput);

    document.getElementById('shippingZip').addEventListener('input', handleZipInput);
    document.getElementById('shippingPostalCode').addEventListener('input', handlePostalCodeInput);

    function updateShippingMask(iCase) {
        if (document.getElementById('shippingCountry').value === 'US') {
            shippingUSCase(iCase);
        } else {
            shippingCACase(iCase);
        }
    }

    function formatPhoneNumber(phoneNumber) {
        const cleaned = ('' + phoneNumber).replace(/\D/g, '');
        const match = cleaned.match(/^(\d{3})(\d{3})(\d{4})$/);
        if (match) {
            return '(' + match[1] + ') ' + match[2] + '-' + match[3];
        }
        return null;
    }

    function handlePhoneInput(event) {
        const input = event.target;
        const value = input.value;
        const formattedValue = formatPhoneNumber(value);
        if (formattedValue) {
            input.value = formattedValue;
        }
    }

    function formatPostalCode(postalCode) {
        const cleaned = postalCode.trim().toUpperCase();
        const match = cleaned.match(/^([A-Za-z]\d[A-Za-z])\s?(\d[A-Za-z]\d)$/);
        if (match) {
            return match[1] + ' ' + match[2];
        }
        return null;
    }

    // Function to format postal code (99999 format)
    function formatZip(postalCode) {
        const cleaned = postalCode.trim();
        const match = cleaned.match(/^\d{5}$/);
        if (match) {
            return match[0];
        }
        return null;
    }

    function handleZipInput(event) {
        const input = event.target;
        const value = input.value;
        const formattedValue = formatZip(value);
        if (formattedValue) {
            input.value = formattedValue;
        }
    }

    function handlePostalCodeInput(event) {
        const input = event.target;
        const value = input.value;
        const formattedValue = formatPostalCode(value);
        if (formattedValue) {
            input.value = formattedValue;
        }
    }

    function setPlaceHolder(id, value) {
        document.getElementById(id).value = value;
    }

    function shippingUSCase(iCase) {
        switchVisibility('shipping-state-us-field', 'shipping-state-ca-field');
        switchVisibility('shipping-zip-code-field', 'shipping-postal-code-field');
        setPlaceHolder("shippingPostalCode", "A1A 1A1");
        if(iCase === 0){
            setPlaceHolder("shippingZip", "");
        }
    }

    function shippingCACase(iCase) {
        switchVisibility('shipping-state-ca-field', 'shipping-state-us-field');
        switchVisibility('shipping-postal-code-field', 'shipping-zip-code-field');
        setPlaceHolder("shippingZip", "11111")
        if(iCase === 0){
            setPlaceHolder("shippingPostalCode", "")
        }
    }

    function switchVisibility(elementIdToShow, elementIdToHide) {
        const elementToShow = document.getElementById(elementIdToShow);
        const elementToHide = document.getElementById(elementIdToHide);
        elementToShow.style.display = "block";
        elementToHide.style.display = "none";
    }

    function showDialog(id) {
        document.getElementById(id).showModal();
    }
</script>

</body>
</html>
